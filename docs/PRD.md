# PRD: 리워크케어(ReWorkCare) - 산재 환자 지원 플랫폼

**최근 업데이트**: 2025-01-14 - 기관 유형 및 진료과목 데이터 추가 완료 (6,101개 업데이트), 산재 절차 타임라인 기능 추가

---

## 1. 프로젝트 개요

### 1.1 프로젝트 목적

산업재해 환자들을 위한 통합 지원 플랫폼 개발. 흩어진 산재 정보를 통합하고 AI 기술로 개인화된 안내를 제공하여 환자들이 겪는 정보 탐색 시간과 심리적 스트레스를 최소 50% 이상 절감하는 것을 목표로 한다.

### 1.2 타겟 유저

- **1차 타겟**: 산재 환자 본인
- **2차 타겟**: 환자 가족 및 보호자
- **페르소나**: 박OO (45세, 남성, 건설 현장 근로자), 이OO (38세, 여성, 남편 간병 중)

### 1.3 핵심 가치

- **공감과 명료함**: 법률/행정 용어가 아닌 직관적인 언어 사용
- **최소한의 조작**: 2클릭 이내로 핵심 정보 접근
- **신뢰성**: 공공데이터 기반의 검증된 정보 제공

### 1.4 시장 규모 및 목표

- **TAM**: 산업재해 근로자 + 가족 약 **60만 명**
- **SAM**: 온라인 정보 이용 가능층 약 **25만 명**
- **SOM**: 초기 2년 내 확보 목표 약 **5만 명**
- **12개월 KPI 목표**: 월간 방문자 50,000명, 전환율 10%, 월 수익 200만 원

### 1.5 타겟 페르소나

#### 1차 페르소나: 박OO (45세, 남성, 건설 현장 근로자)
- **상황**: 손목 부상으로 치료 중
- **페인포인트**: 복잡한 산재 절차로 인한 혼란과 스트레스
- **니즈**: 단계별로 안내되는 명확한 신청 절차

#### 2차 페르소나: 이OO (38세, 여성, 전업주부)
- **상황**: 남편이 산재로 입원 중
- **페인포인트**: 행정 절차, 병원 이동, 복지 정보 부족
- **니즈**: 종합적인 케어 가이드와 실질적인 지원 정보

---

## 2. MVP 핵심 기능 (Phase 1)

### 2.1 내 주변 산재 지정 의료기관 찾기

#### 기능 설명

사용자가 위치 기반으로 산재 지정 병원, 약국, 재활기관을 찾아 지도에서 확인하고 상세 정보를 조회

#### 상세 요구사항

- **위치 권한 요청**

  - 앱 진입 시 위치 정보 접근 권한 요청
  - 허용 시 즉시 지도가 로딩되어야 함

- **지도 표시**

  - 사용자 위치 기준 반경 5km 내 병원/약국/재활기관 표시
  - 핀 형태로 시각화
  - 기관 유형별 필터링 (병원/약국/재활기관)

- **상세 정보**

  - 핀/리스트 클릭 시 기관명, 주소, 연락처, 기관 유형, 진료과목(병원) 또는 기관구분(재활기관) 표시
  - Bottom Sheet 형태로 표시
  - 전화 걸기, 길찾기 기능 포함
  - 기관 유형 표시: 대학병원, 종합병원, 병원, 의원, 한의원, 요양병원 등 (기관명에서 자동 추출)
  - 진료과목 표시: 정형외과, 신경외과, 재활의학과, 치과 등 (기관명에서 자동 추출)
  - 재활기관의 경우: 직업훈련기관, 재활스포츠기관, 심리재활프로그램 위탁기관 구분 표시

- **진료과목 필터**

  - 정형외과, 내과 등 진료과목별 필터링

#### 기술 요구사항

- 공공데이터포털(data.go.kr) API 활용
  - 산재 지정 의료기관 현황정보 API (병원/약국)
  - 산재재활기관관리정보 API (재활기관: 직업훈련기관, 재활스포츠기관, 심리재활프로그램 위탁기관)
- 네이버 또는 카카오 지도 API 연동
- 반경 5km 이내 검색 (5km, 10km, 15km, 30km 선택 가능)
- 모바일 우선 반응형 디자인

#### UI 요구사항

- **반응형 웹 디자인**: 데스크톱, 태블릿, 모바일 모든 화면 크기 지원
- **데스크톱 최적화**: 컴퓨터 화면에서도 완벽하게 작동하는 레이아웃
- **모바일 우선 접근**: 모바일에서 우수한 경험 제공, 데스크톱에서 확장
- 직관적인 지도 인터페이스
- 빠른 로딩 속도 (2초 이내)

#### 디자인 요구사항

##### 색상 팔레트
- **Primary**: `#3478F6` (차분한 파란색) - 신뢰, 안정, 전문성
- **Secondary**: `#34C759` (부드러운 녹색) - 치유, 희망, 긍정
- **Alert**: `#FF9500` (부드러운 주황색) - 법적 고지, 주의 사항

##### 타이포그래피
- **폰트**: Pretendard (프리텐더드)
- **제목 (H1)**: `28px` (Bold)
- **소제목 (H2)**: `22px` (SemiBold)
- **본문**: `17px` (Regular)
- **캡션**: `14px` (Regular)

##### 레이아웃 원칙

**반응형 네비게이션 구조**:
- **모바일 (< 768px)**: 하단 탭 바 `[병원 찾기] | [서류 안내]`
- **태블릿 (768px ~ 1024px)**: 상단 또는 사이드 네비게이션
- **데스크톱 (> 1024px)**: 상단 네비게이션 또는 사이드바

**반응형 브레이크포인트**:
- **모바일**: 320px ~ 767px
- **태블릿**: 768px ~ 1023px
- **데스크톱**: 1024px 이상

**공통 컴포넌트**:
- **정보 카드**: 둥근 모서리, 부드러운 그림자 효과
- **아코디언 UI**: 단계별 정보 표시 (정보 과부하 방지)
- **반응형 그리드**: 화면 크기에 따라 자동 조정되는 레이아웃

---

### 2.2 핵심 산재 서류 AI 요약 가이드

#### 기능 설명

복잡한 산재 서류들을 AI가 쉽고 간단하게 요약 설명하여 환자들이 단계별로 따라 할 수 있도록 안내

#### 상세 요구사항

- **서류 목록 제공**

  - 요양급여신청서, 휴업급여청구서 등 핵심 서류 목록
  - 각 서류의 목적과 용도에 대한 AI 요약
  - 주요 항목별 작성 가이드 (블록 카드 UI)

- **AI 요약 기능**

  - gpt-4-turbo 모델 사용 (Temperature 0.3)
  - 안정적이고 신뢰할 수 있는 정보 제공

- **면책 조항 표시**

  - 모든 정보 페이지 상/하단에 법적 책임 한계 명시
  - "※ 이 내용은 법률적/의학적 자문이 아니며, 참고용 정보입니다."

#### 기술 요구사항

- OpenAI API 연동
- 안전한 정보 제공을 위한 프롬프트 엔지니어링
- 명확한 UI 구분 (요약/가이드 섹션)

#### UI 요구사항

- 직관적인 블록 카드 레이아웃
- 명확한 섹션 구분
- 모바일 친화적 디자인
- **아코디언 UI**: 서류 목록을 제목만 표시, 터치 시 펼쳐짐
- **면책 조항 배너**: 주황색 배경으로 법적 고지 명확히 표시

---

### 2.3 산재 절차 타임라인 가이드

#### 기능 설명

산재 환자와 가족(산재 초보자)을 위한 "사고 → 승인 → 치료 → 장해 → 사회복귀" 전 과정을 시각적 타임라인으로 한눈에 이해할 수 있도록 제공하는 기능입니다. 각 단계별로 지금 해야 할 행동, 필수 서류, 가장 자주 생기는 문제와 주의사항, 다음 단계로 넘어가는 조건을 명확히 안내합니다.

#### 상세 요구사항

- **4단계 타임라인 구조**
  - Step 1: 산재 최초 신청 (인정 단계)
  - Step 2: 요양 및 치료 + 휴업급여
  - Step 3: 치료 종결 및 장해 심사
  - Step 4: 사회 복귀 및 직업 재활

- **각 단계별 정보 제공**
  - 지금 해야 할 행동 (체크리스트 형태)
  - 필수 서류 목록 (PDF 다운로드 링크 포함)
  - 가장 흔한 문제 / 주의사항
  - 다음 단계로 넘어가는 조건

- **법적 고지 (필수)**
  - 모든 타임라인 화면 상단 고정 노출
  - "본 페이지는 일반적인 산재 절차 안내를 목적으로 하며, 실제 적용 여부는 근로복지공단의 판단과 개별 사안에 따라 달라질 수 있습니다. 본 정보는 법적 효력을 갖지 않습니다."

#### 기술 요구사항

- **Supabase 데이터베이스 테이블**
  - `stages`: 단계 정보 (step_number, title, description, next_condition)
  - `documents`: 단계별 필수 서류 (stage_id, title, pdf_url, is_required)
  - `warnings`: 단계별 주의사항 (stage_id, content)
  - 향후 확장: `user_stage_progress`, `user_documents_progress` (개인화 기능)

- **PDF 제공 정책**
  - 공식 링크 우선 제공 (근로복지공단 공식 사이트)
  - 공식 링크가 없는 경우 로컬 PDF 파일 제공 (`/pdf/` 폴더)
  - 기존 PDF 뷰어 페이지(`/view-pdf`) 재사용

#### UI 요구사항

- **반응형 타임라인 디자인**
  - 모바일 (< 768px): 세로 타임라인 (위에서 아래로 흐름)
  - 데스크톱 (≥ 768px): 가로 타임라인 (왼쪽에서 오른쪽으로 흐름)

- **단계 카드 인터랙션**
  - 단계 카드 클릭 시 Full Screen Modal 오픈 (모바일) 또는 하단 슬라이드 패널 (데스크톱)
  - 모달/패널 내부 탭 구조:
    1. 지금 해야 할 일
    2. 필수 서류 (PDF 다운로드 버튼 포함)
    3. 주의사항 / 분쟁 포인트
  - 하단: "다음 단계 보기" 버튼

- **단계 상태 표시** (향후 개인화 기능)
  - 기본(회색): 아직 시작하지 않은 단계
  - 활성(블루): 현재 진행 중인 단계
  - 완료(그린): 완료된 단계

- **디자인 통합**
  - 기존 Warm & Rounded 테마 유지
  - 기존 UI 컴포넌트 재사용 (Sheet, Dialog, Button 등)
  - 기존 색상 시스템 활용 (Primary Green)

#### MVP 범위

- 로그인 없이 단순 안내용 제공
- 모든 사용자에게 동일한 타임라인 표시
- PDF 다운로드 및 뷰어 기능

#### 2차 확장 계획 (Phase 2)

- Clerk 로그인 연동
- 사용자별 진행 단계 추적 및 저장
- 개인화된 필요 서류 체크리스트
- RAG 챗봇 자동 연동 (개인 진행 상황 기반 질문 추천)
- 완료/진행중 상태 UI 반영

#### 성공 기준

- 산재 초보자가 다음을 **3분 안에** 이해할 수 있어야 함:
  - "지금 내가 어디 단계인지"
  - "지금 당장 해야 할 행동"
  - "어떤 서류를 언제 내야 하는지"

---

## 3. 기술 스택

### 3.1 Frontend

| 구성 요소 | 기술 | 목적 |
|----------|------|------|
| **Framework** | Next.js 15 (App Router) | SEO 최적화, 서버 사이드 렌더링 |
| **Language** | TypeScript | 타입 안정성 및 개발 생산성 |
| **Styling** | Tailwind CSS v4 | 반응형 디자인 및 일관된 UI |
| **UI Components** | shadcn/ui | 접근성 높은 컴포넌트 라이브러리 |
| **Maps** | Naver/Kakao Maps API | 위치 기반 병원 정보 시각화 |
| **Icons** | Lucide React | 일관된 아이콘 시스템 |

### 3.2 Backend & Infrastructure

| 구성 요소 | 기술 | 목적 |
|----------|------|------|
| **Database** | Supabase (PostgreSQL) | 병원/약국 데이터 캐시, 사용자 로그 저장, 타임라인 단계 정보 저장 |
| **Authentication** | Clerk | 소셜 로그인, 세션 관리 |
| **AI** | OpenAI API (gpt-4-turbo) | 서류 작성 가이드 및 요약 생성 |
| **Hosting** | Vercel | 프론트엔드 배포 및 Edge 네트워크 |
| **Monitoring** | Supabase Logs + Vercel Analytics | 트래픽 및 에러 모니터링 |
| **Storage** | Supabase Storage | 이미지 및 캐시 데이터 저장 |

### 3.3 API & Data Sources

| API | 엔드포인트 | 용도 | 요청 빈도 | 데이터 수 |
|-----|-----------|------|----------|----------|
| **공공데이터포털 (의료기관)** | `api.odcloud.kr/api/3044320/v1` | 산재 지정 의료기관 정보 조회 (병원/약국) | 실시간 | 5,216개 |
| **공공데이터포털 (재활기관)** | `apis.data.go.kr/B490001/sjbJhgigwanGwanriInfoService` | 산재재활기관관리정보 조회 (직업훈련기관, 재활스포츠기관, 심리재활프로그램 위탁기관) | 실시간 | 2,415개 |
| **지도 API** | Naver Maps v3 | 위치 기반 시각화 | 실시간 | - |
| **Geocoding API** | Naver Maps Geocoding / VWorld | 주소 → 위도/경도 변환 | 배치 처리 | - |
| **OpenAI** | `gpt-4-turbo` | AI 서류 요약 가이드 | 사용자 요청 시 | - |

### 3.4 시스템 아키텍처

```
[사용자 브라우저]
      ↓
[Next.js Frontend] ←→ [Supabase DB/Auth/Storage]
      ↓                      ↓
[OpenAI API]          [공공데이터포털 API]
      ↓                      ↓
[AI 요약 가이드]     [병원/약국/재활기관 데이터 캐싱]
      ↓                      ↓
                    [Geocoding API]
                          ↓
                    [주소 → 좌표 변환]
```

---

## 4. 사용자 플로우 (MVP)

1. **진입 및 탐색**: 박OO씨가 위치 권한을 허용하자 주변 산재 지정 병원/약국/재활기관이 지도에 표시
2. **정보 확인**: 정형외과 필터 적용 후 가까운 병원 선택, 또는 재활기관 필터로 직업훈련기관 확인, 상세 정보 확인 및 전화 연락
3. **서류 준비**: 병원 방문 후 서류 메뉴에서 요양급여신청서 선택, AI 요약 가이드 확인 후 준비
4. **절차 안내**: 타임라인 메뉴에서 전체 산재 절차 확인, 현재 단계 파악 및 다음 단계 준비

---

## 5. 성공 지표 (Phase 1 목표)

### 5.1 핵심 KPI (12개월 목표)

| 구분 | 지표 | 목표 | 측정 방법 |
|------|------|------|-----------|
| **사용자 유입** | 월간 방문자 수 | **50,000명** | Google Analytics |
| **사용자 참여** | 서류 다운로드/상담 클릭률 | **10%** | 전환율 추적 |
| **사용자 유지** | 재방문 사용자 비율 | **25%** | 재방문율 분석 |
| **수익성** | 광고/제휴 수익 | **월 200만 원** | 매출 리포트 |
| **사용자 만족** | 만족도 설문 긍정 응답률 | **80%** | 정기 설문조사 |

### 5.2 Phase 1 기능별 성공 기준

#### 기능적 지표
- ✅ 병원 찾기 기능: 지도 로딩 성공률 > 98%
- ✅ 서류 가이드 기능: AI 응답 정확도 > 90%
- ✅ 타임라인 기능: 타임라인 페이지 로드 성공률 > 98%
- ✅ API 안정성: 전체 API 응답 성공률 > 95%

#### 사용자 경험 지표
- ✅ 페이지 로드 시간: 초기 로드 < 3초, 상호작용 < 2초
- ✅ 모바일 최적화: 모바일 사용자 비율 > 70%
- ✅ 오류 발생률: 사용자당 일일 오류 < 0.1%

#### 기술적 안정성 지표
- ✅ 서버 응답 시간: 평균 < 500ms
- ✅ 가용성: 월간 uptime > 99.5%
- ✅ 데이터 정확성: 병원 정보 업데이트 정확도 > 99%

---

## 6. 기술 제약사항 및 NFRs (Non-Functional Requirements)

### 6.1 성능 요구사항

| 항목 | 목표 | 측정 방법 |
|------|------|-----------|
| **초기 로드 속도** | 3초 이내 (모바일 기준) | Lighthouse, Web Vitals |
| **지도 로드 응답** | 2초 이내 | Performance API |
| **API 응답 시간** | < 500ms | Network 탭, Server logs |
| **동시 접속 처리** | 1,000명 이상 | Load testing |
| **서버 확장성** | Auto-scaling 지원 | Vercel + Supabase Edge |

### 6.2 보안 및 프라이버시 요구사항

#### 데이터 보호
- **HTTPS 암호화**: TLS 1.3 사용 (모든 통신)
- **개인정보 최소화**: 이메일 외 개인정보 저장 금지
- **위치 데이터**: 저장하지 않고 세션 내에서만 처리

#### API 보안
- **API 키 보호**: 환경변수로 관리, 서버 사이드 전용
- **Rate Limiting**: 공공 API 호출 제한 준수
- **CORS 정책**: 허용된 도메인만 접근 허용

### 6.3 접근성 및 사용성 요구사항

#### 접근성 (WCAG 2.1 AA 준수)
- **색상 대비**: 텍스트/배경 대비율 4.5:1 이상
- **키보드 네비게이션**: 모든 기능 키보드 접근 가능
- **스크린 리더**: ARIA 라벨 및 의미론적 HTML 사용

#### 사용성
- **반응형 디자인**: 320px 이상 모든 디바이스 지원 (모바일, 태블릿, 데스크톱)
- **데스크톱 최적화**: 마우스 인터랙션 및 넓은 화면 활용
- **모바일 최적화**: 터치 인터랙션 및 작은 화면 최적화
- **터치 타겟**: 모바일에서 최소 44px × 44px 터치 영역
- **에러 처리**: 사용자 친화적 에러 메시지

### 6.4 확장성 및 유지보수 요구사항

#### 아키텍처 설계
- **컴포넌트 모듈화**: 재사용 가능한 UI 컴포넌트
- **API 설계**: RESTful API 패턴 준수
- **코드 품질**: TypeScript 엄격 모드, ESLint 준수

#### 배포 및 모니터링
- **CI/CD**: GitHub Actions 자동 배포
- **모니터링**: 에러 추적 및 성능 모니터링
- **백업**: 데이터베이스 자동 백업 (매일)

### 6.5 리스크 및 대응 전략

| 리스크 | 심각도 | 대응 방안 |
|--------|--------|-----------|
| **공공데이터 API 불안정** | 🟡 Medium | Supabase 캐시 DB 운영, 다중 백업 |
| **OpenAI API 비용 증가** | 🟡 Medium | 호출 제한 + 캐싱 전략 적용 |
| **법적 해석 문제** | 🔴 High | 면책 조항 명확화, 전문가 검토 |
| **개인정보 유출** | 🔴 High | 최소 정보 정책, 암호화 적용 |

---

## 7. UI/UX 원칙 및 디자인 가이드라인

### 7.1 코어 디자인 철학

**"디지털 케어 코디네이터"** - 병원의 친절한 코디네이터처럼 사용자를 안내하는 경험

#### 3가지 핵심 원칙
- **Calm (차분함)**: 시각적 자극 최소화, 인지적 부담 감소
- **Clarity (명료함)**: 다음 단계 즉시 파악 가능
- **Guidance (길잡이)**: 자연스러운 방향 안내

### 7.2 디자인 시스템

#### 색상 시스템
- **Primary**: `#3478F6` - 신뢰, 안정, 전문성
- **Secondary**: `#34C759` - 치유, 희망, 긍정
- **Neutral**: `#F2F2F7` (배경), `#1C1C1E` (텍스트), `#8A8A8E` (보조)
- **Alert**: `#FF9500` - 법적 고지, 주의 사항

#### 타이포그래피 스케일
- **H1**: 28px Bold (페이지 제목)
- **H2**: 22px SemiBold (섹션 제목)
- **Body**: 17px Regular (본문, 모바일 최적화)
- **Caption**: 14px Regular (보조 정보)

### 7.3 주요 컴포넌트 패턴

#### 반응형 네비게이션
- **모바일 (< 768px)**: 하단 탭 바 - `[병원 찾기] | [서류 안내] | [산재 상담] | [진행 과정]` (4개 탭)
- **태블릿/데스크톱 (≥ 768px)**: 상단 네비게이션 바
- 아이콘 + 텍스트 조합으로 명확성 확보
- 화면 크기에 따라 자동 전환

#### 타임라인 컴포넌트
- **모바일**: 세로 타임라인 (위에서 아래로 흐름)
- **데스크톱**: 가로 타임라인 (왼쪽에서 오른쪽으로 흐름)
- 단계 카드 클릭 시 Full Screen Modal (모바일) 또는 슬라이드 패널 (데스크톱)
- 탭 기반 상세 정보 표시 (해야 할 일 / 서류 / 주의사항)

#### 정보 카드 (Info Card)
- 둥근 모서리, 부드러운 그림자 효과
- 정보 단위별 명확한 구분

#### 단계별 아코디언 (Accordion)
- 복잡한 절차를 단계별로 표시
- 정보 과부하 방지, 현재 단계 집중

---

## 8. Phase 1 개발 일정

### 8.1 기본 구조 & 공통 설정

- [ ] 프로젝트 셋업 및 환경 구성
- [ ] Supabase/Clerk 연동 설정
- [ ] 기본 컴포넌트 및 레이아웃 구성

### 8.2 병원 찾기 기능 구현

- [ ] 공공데이터 API 클라이언트 구현
  - [x] 산재 지정 의료기관 API 연동 (병원/약국) ✅ 완료
  - [x] 산재재활기관관리정보 API 연동 (재활기관) ✅ 완료
- [ ] 지도 API 연동 및 마커 표시
  - [x] 병원/약국 마커 표시 ✅ 완료
  - [ ] 재활기관 마커 표시 (병원/약국과 통합)
- [ ] 위치 기반 검색 및 필터링
  - [x] 반경 검색 (5km, 10km, 15km, 30km) ✅ 완료
  - [ ] 기관 유형별 필터링 (병원/약국/재활기관)
  - [ ] 진료과목별 필터링
- [ ] 상세 정보 표시 및 인터랙션
  - [x] 병원/약국 상세 정보 표시 ✅ 완료
  - [ ] 재활기관 상세 정보 표시

### 8.3 서류 가이드 기능 구현

- [ ] OpenAI API 연동
- [ ] 서류 목록 및 요약 가이드 구현
- [ ] UI/UX 최적화 및 테스트

### 8.4 산재 절차 타임라인 기능 구현

- [ ] Supabase 테이블 생성
  - [ ] `stages` 테이블 생성 (단계 정보)
  - [ ] `documents` 테이블 생성 (단계별 필수 서류)
  - [ ] `warnings` 테이블 생성 (단계별 주의사항)
  - [ ] 4단계 Seed 데이터 입력
- [ ] 타임라인 UI 구현
  - [ ] TimelineContainer 기본 레이아웃 (반응형: 모바일 세로 / 데스크톱 가로)
  - [ ] TimelineStepCard 컴포넌트 (단계 카드)
  - [ ] TimelineDetailPanel 컴포넌트 (상세 정보 패널/모달)
  - [ ] LegalNotice 컴포넌트 (법적 고지 상단 고정)
- [ ] 인터랙션 구현
  - [ ] 단계 카드 클릭 이벤트 처리
  - [ ] Full Screen Modal (모바일) / 슬라이드 패널 (데스크톱) 구현
  - [ ] 탭 UI 구현 (해야 할 일 / 서류 / 주의사항)
  - [ ] PDF 다운로드 버튼 연결 (기존 PDF 뷰어 연동)
- [ ] 네비게이션 통합
  - [ ] Navbar에 "진행 과정" 메뉴 추가
  - [ ] ResponsiveNavigation에 "진행 과정" 탭 추가 (아이콘: Timeline 또는 List)
- [ ] 라우팅 설정
  - [ ] `/timeline` 페이지 생성
  - [ ] 기존 라우트와 충돌 확인 및 해결

### 8.5 최적화 및 배포

- [ ] 성능 최적화 (지도 로딩 2초 이내)
- [ ] 반응형 디자인 완성
- [ ] Vercel 배포 및 테스트

---