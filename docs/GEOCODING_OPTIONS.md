# Geocoding API ì˜µì…˜ ë° ë¹„ìš© ë¹„êµ

## ğŸ“Š ë¹„ìš© ë¹„êµ

### 1. VWorld API (í˜„ì¬ ì‚¬ìš© ì¤‘) â­

**ë¬´ë£Œ í• ë‹¹ëŸ‰**: ì›” **40,000ê±´** ë¬´ë£Œ  
**ì œê³µ ê¸°ê´€**: êµ­í† êµí†µë¶€  
**API ë¬¸ì„œ**: https://www.vworld.kr/dev/v4dv_geocoderguide2_s001.do

**ì¥ì **:
- âœ… **ì™„ì „ ë¬´ë£Œ** (ì›” 4ë§Œ ê±´)
- âœ… í•œêµ­ ì£¼ì†Œì— ìµœì í™” (êµ­í† êµí†µë¶€ ê³µì‹ ë°ì´í„°)
- âœ… ì •í™•ë„ ë†’ìŒ
- âœ… ìƒì—…ì  ì‚¬ìš© ê°€ëŠ¥
- âœ… API í‚¤ ë°œê¸‰ ê°„ë‹¨

**ë‹¨ì **:
- âš ï¸ ì›” 4ë§Œ ê±´ ì œí•œ (ì´ˆê³¼ ì‹œ ë‹¤ìŒ ë‹¬ê¹Œì§€ ëŒ€ê¸°)
- âš ï¸ HTTP API (HTTPS ë¯¸ì§€ì›, ì¼ë¶€ í™˜ê²½ì—ì„œ ì œí•œ ê°€ëŠ¥)

**í˜„ì¬ í”„ë¡œì íŠ¸ ì‚¬ìš©ëŸ‰**:
- CSV íŒŒì¼: ì•½ 6,000ê°œ ì£¼ì†Œ
- **ë¬´ë£Œ í•œë„ ë‚´** âœ… (ì›” 40,000ê±´ ì¤‘ 6,000ê±´ ì‚¬ìš©)

---

### 2. ë„¤ì´ë²„ Maps API (ìœ ë£Œ ì „í™˜ë¨)

**ë¬´ë£Œ í• ë‹¹ëŸ‰**: ì—†ìŒ (ìœ ë£Œ ì „í™˜)  
**ë¹„ìš©**: ì‚¬ìš©ëŸ‰ì— ë”°ë¼ ê³¼ê¸ˆ

**ì¥ì **:
- âœ… í•œêµ­ ì£¼ì†Œì— ìµœì í™”
- âœ… ì •í™•ë„ ë†’ìŒ

**ë‹¨ì **:
- âš ï¸ **ìœ ë£Œ ì„œë¹„ìŠ¤** (ë¹„ìš© ë°œìƒ)
- âš ï¸ API í‚¤ ê´€ë¦¬ í•„ìš”

---

### 2. OpenStreetMap Nominatim (ì™„ì „ ë¬´ë£Œ)

**ë¹„ìš©**: **ì™„ì „ ë¬´ë£Œ** (ìƒì—…ì  ì‚¬ìš© ê°€ëŠ¥)  
**ì œí•œ**: 
- ì´ˆë‹¹ 1íšŒ ìš”ì²­ (Rate Limit)
- ì¼ì¼ ì•½ 2,000-3,000ê±´ ê¶Œì¥
- ëŒ€ëŸ‰ ìš”ì²­ ì‹œ ìì²´ ì„œë²„ êµ¬ì¶• ê¶Œì¥

**ì¥ì **:
- âœ… ì™„ì „ ë¬´ë£Œ
- âœ… ì „ ì„¸ê³„ ë°ì´í„°
- âœ… ì˜¤í”ˆì†ŒìŠ¤

**ë‹¨ì **:
- âš ï¸ í•œêµ­ ì£¼ì†Œ ì •í™•ë„ê°€ ë„¤ì´ë²„ë³´ë‹¤ ë‚®ì„ ìˆ˜ ìˆìŒ
- âš ï¸ Rate Limitì´ ì—„ê²©í•¨ (ì´ˆë‹¹ 1íšŒ)
- âš ï¸ 6,000ê°œ ì²˜ë¦¬ ì‹œ ì•½ 1.5-2ì‹œê°„ ì†Œìš”

**ì—”ë“œí¬ì¸íŠ¸**:
```
https://nominatim.openstreetmap.org/search?q={ì£¼ì†Œ}&format=json&limit=1
```

---

### 3. ì¹´ì¹´ì˜¤ Maps API

**ë¬´ë£Œ í• ë‹¹ëŸ‰**: í™•ì¸ í•„ìš” (ê³µì‹ ë¬¸ì„œ ì°¸ì¡°)  
**ì´ˆê³¼ ì‹œ**: ì¶”ê°€ ë¹„ìš© ë°œìƒ

**ì¥ì **:
- âœ… í•œêµ­ ì£¼ì†Œì— ìµœì í™”
- âœ… ì •í™•ë„ ë†’ìŒ

**ë‹¨ì **:
- âš ï¸ API í‚¤ ë°œê¸‰ í•„ìš”
- âš ï¸ ë¬´ë£Œ í• ë‹¹ëŸ‰ í™•ì¸ í•„ìš”

---

### 4. Google Maps Geocoding API

**ë¬´ë£Œ í• ë‹¹ëŸ‰**: ì›” **40,000ê±´** ë¬´ë£Œ  
**ì´ˆê³¼ ì‹œ**: $5.00 per 1,000ê±´

**ì¥ì **:
- âœ… ì „ ì„¸ê³„ ë°ì´í„°
- âœ… ì •í™•ë„ ë§¤ìš° ë†’ìŒ

**ë‹¨ì **:
- âš ï¸ ë¬´ë£Œ í• ë‹¹ëŸ‰ì´ ì ìŒ (ì›” 4ë§Œ ê±´)
- âš ï¸ ì´ˆê³¼ ì‹œ ë¹„ìš©ì´ ë†’ìŒ
- âš ï¸ API í‚¤ ë°œê¸‰ ë° ê²°ì œ ì •ë³´ í•„ìš”

---

## ğŸ’¡ ê¶Œì¥ ì‚¬í•­

### í˜„ì¬ í”„ë¡œì íŠ¸ (6,000ê°œ ì£¼ì†Œ)

**VWorld API ì‚¬ìš© ê¶Œì¥** âœ…

ì´ìœ :
1. **ì™„ì „ ë¬´ë£Œ**: ì›” 40,000ê±´ ë¬´ë£Œ ì œê³µ
2. **í•œêµ­ ì£¼ì†Œ ìµœì í™”**: êµ­í† êµí†µë¶€ ê³µì‹ ë°ì´í„°
3. **ì •í™•ë„ ë†’ìŒ**: ê³µê³µ ë°ì´í„° ê¸°ë°˜
4. **ë¬´ë£Œ í•œë„ ë‚´**: ì›” 40,000ê±´ ì¤‘ 6,000ê±´ë§Œ ì‚¬ìš©
5. **ìƒì—…ì  ì‚¬ìš© ê°€ëŠ¥**: ì œì•½ ì—†ìŒ

**ì˜ˆìƒ ë¹„ìš©**: **0ì›** (ë¬´ë£Œ í• ë‹¹ëŸ‰ ë‚´)

---

### ë¬´ë£Œ ëŒ€ì•ˆì´ í•„ìš”í•œ ê²½ìš°

#### ì˜µì…˜ 1: OpenStreetMap Nominatim ì‚¬ìš©

**ì¥ì **: ì™„ì „ ë¬´ë£Œ  
**ë‹¨ì **: ì²˜ë¦¬ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼ (ì•½ 1.5-2ì‹œê°„)

êµ¬í˜„ ë°©ë²•:
1. `lib/api/geocoding-nominatim.ts` ìƒì„±
2. Nominatim API í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
3. CSV import APIì—ì„œ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©

#### ì˜µì…˜ 2: í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹

1. **ë„¤ì´ë²„ APIë¡œ ë¨¼ì € ì‹œë„** (ë¬´ë£Œ í• ë‹¹ëŸ‰ ë‚´)
2. **ì‹¤íŒ¨ ì‹œ Nominatimìœ¼ë¡œ í´ë°±** (ì™„ì „ ë¬´ë£Œ)

---

## ğŸ”§ êµ¬í˜„ ì˜ˆì‹œ: Nominatim Geocoding

```typescript
// lib/api/geocoding-nominatim.ts
class NominatimGeocodingClient {
  private baseUrl = 'https://nominatim.openstreetmap.org';
  private delayMs = 1000; // Rate Limit: ì´ˆë‹¹ 1íšŒ

  async geocode(address: string): Promise<Coordinates | null> {
    const url = new URL(`${this.baseUrl}/search`);
    url.searchParams.set('q', address);
    url.searchParams.set('format', 'json');
    url.searchParams.set('limit', '1');
    url.searchParams.set('countrycodes', 'kr'); // í•œêµ­ë§Œ ê²€ìƒ‰

    try {
      const response = await fetch(url.toString(), {
        headers: {
          'User-Agent': 'ReWorkCare/1.0', // í•„ìˆ˜
        },
      });

      if (!response.ok) {
        return null;
      }

      const data = await response.json();
      if (data.length === 0) {
        return null;
      }

      return {
        latitude: parseFloat(data[0].lat),
        longitude: parseFloat(data[0].lon),
      };
    } catch (error) {
      console.error('[Nominatim] Geocoding ì‹¤íŒ¨:', error);
      return null;
    }
  }

  async geocodeBatch(
    addresses: string[],
    delayMs: number = 1000
  ): Promise<Map<string, Coordinates | null>> {
    const results = new Map<string, Coordinates | null>();

    for (const address of addresses) {
      const coordinates = await this.geocode(address);
      results.set(address, coordinates);

      // Rate Limit ì¤€ìˆ˜
      await new Promise(resolve => setTimeout(resolve, delayMs));
    }

    return results;
  }
}
```

---

## ğŸ“ ê²°ë¡ 

**í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” ë„¤ì´ë²„ Maps API ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤:**

1. âœ… ë¬´ë£Œ í• ë‹¹ëŸ‰ ì¶©ë¶„ (ì›” 300ë§Œ ê±´)
2. âœ… í˜„ì¬ ì‚¬ìš©ëŸ‰ ì ìŒ (6,000ê±´)
3. âœ… ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆìŒ
4. âœ… í•œêµ­ ì£¼ì†Œ ì •í™•ë„ ë†’ìŒ
5. âœ… ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„

**ë¹„ìš©**: **0ì›** (ë¬´ë£Œ í• ë‹¹ëŸ‰ ë‚´)

ë§Œì•½ ë¬´ë£Œ ëŒ€ì•ˆì´ í•„ìš”í•˜ë‹¤ë©´ OpenStreetMap Nominatimì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

